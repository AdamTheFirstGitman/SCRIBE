# SCRIBE - Syst√®me Plume & Mimir

## Configuration Projet

*Syst√®me de gestion de connaissances avec agents IA intelligents*

### Architecture Multi-Agents Op√©rationnelle ‚úÖ

**Agents Principaux :**
- **üñãÔ∏è Plume** - Agent restitution parfaite : capture, transcription, reformulation pr√©cise
- **üß† Mimir** - Agent archiviste : indexation, recherche RAG, connections m√©thodiques
- **üé≠ LangGraph Orchestrator** - Workflow intelligent : routing automatique, discussions agents
- **ü§ù AutoGen Integration** - Dialogues structur√©s entre agents pour qualit√© optimale

**Agents de Build (Forge EMPYR) :**
- **Leo** - Architecte principal, task decomposition hi√©rarchique
- **Koda** - Codeur sp√©cialis√© patterns FastAPI/CRUD
- **Gito** - Git MCP, gestion repositories
- **KodaF** - Frontend specialist, UI/UX transformation professionnel ‚≠ê

### Architecture Technique Compl√®te

**Stack Frontend :**
- NextJS 14 + App Router + TypeScript strict
- PWA compl√®te avec service worker avanc√©
- **shadcn/ui + CVA Professional Design System** ‚≠ê
- **Interface mobile-first avec dark theme + animations fluides**
- **Support offline + installation prompt PWA**

**Stack Backend :**
- FastAPI + LangGraph + AutoGen
- Architecture multi-agents avec state management
- Services IA complets (transcription, embeddings, RAG)
- Cache multi-niveaux optimis√©

**Infrastructure Data :**
- Supabase Pro + pgvector pour embeddings
- PostgreSQL avec RLS et fonctions RPC
- Redis Cloud pour cache haute performance
- Realtime sync bidirectionnel

### Services IA Int√©gr√©s

**üéôÔ∏è Transcription Service :**
- OpenAI Whisper API
- Formats multiples : webm, mp3, wav, m4a, ogg
- Cache intelligent avec validation audio
- Gestion costs et performance

**üîç Embeddings Service :**
- text-embedding-3-large (1536 dimensions)
- Chunking s√©mantique intelligent
- Batch processing optimis√©
- Cache persistant Redis

**üß¨ RAG Avanc√© :**
- Recherche hybride (vector + fulltext + BM25)
- Re-ranking avec cross-encoder
- Contexte dynamique adaptatif
- Sources tracking avec confidence

**ü§ñ LLM Multi-Model :**
- Claude Opus (agents principaux)
- OpenAI (embeddings + Whisper)
- Perplexity (recherche temps r√©el)
- Routing intelligent selon contexte

### Phases de D√©veloppement

#### ‚úÖ Phase 1 : Infrastructure
- [x] Database Schema (Supabase + pgvector)
- [x] Backend FastAPI (Structure + Services + API)
- [x] Frontend NextJS (PWA + Tailwind + TypeScript)
- [x] Cache System (Redis multi-niveaux)

#### ‚úÖ Phase 2 : Agents Core
- [x] LangGraph Orchestrator (Workflow + State + Decision trees)
- [x] Plume Agent (Restitution parfaite + cache + HTML)
- [x] Mimir Agent (RAG + recherche + r√©f√©rences)
- [x] AutoGen Integration (Discussion + fallback)
- [x] Services IA (Transcription + Embeddings + RAG)

#### ‚úÖ Phase 3 : Upload & Conversion
- [x] Document Upload Pipeline (drag & drop + validation)
- [x] Smart Text-to-HTML Conversion (headers + links + lists)
- [x] Toggle View Component (TEXT ‚Üî HTML mobile-first)
- [x] Chunking Service (semantic boundaries + overlap)
- [x] Demo Interface (light theme + clean design)

#### ‚úÖ Phase 4 : Interface Chat
- [x] Chat Interface (Vocal + Textuel + animations)
- [x] Mobile-first design avec toggle agents
- [x] Voice recording + transcription
- [x] Message bubbles + loading states
- [x] Real-time WebSocket connections

#### ‚úÖ Phase 5 : RAG & Int√©grations
- [x] API Endpoints Complete (REST + SSE + WebSocket)
- [x] RAG State-of-the-Art (Knowledge graph + auto-tuning)
- [x] Realtime Integration (Subscriptions + sync)
- [x] Advanced Search (hybrid vector+fulltext+BM25)
- [x] Web Search Integration (Perplexity + Tavily)
- [x] Collaborative Features (typing, user status)

#### ‚úÖ Phase 6 : Production DEPLOYMENT SUCCESS! üöÄ
- [x] Performance Optimization (CDN + scaling + monitoring)
- [x] Architecture Review (95% alignment validation)
- [x] Comprehensive Error Handling & Recovery
- [x] Monitoring & Analytics Dashboards
- [x] Automated Backup & Data Protection
- [x] End-to-End Testing Suite (Playwright)
- [x] Offline PWA Support (Service Workers + IndexedDB)
- [x] **Render Backend Deployment** (scribe-api ‚úÖ LIVE)
- [x] **Render Frontend Deployment** (scribe-frontend ‚úÖ LIVE)
- [x] **Render Debug Complete** (13 backend + 2 frontend issues r√©solues)
- [x] **Agent Alex Frontend Enhancement** (UI professionnelle compl√®te)
- [x] **Production Ready Status** (Backend + Frontend d√©ploy√©s)

#### üìã Phase 7 : Polish & Advanced UX
- [ ] Streaming Chat (Vercel AI SDK + LangGraph hybrid)
- [ ] Micro-interactions avanc√©es (animations, transitions fluides)
- [ ] Keyboard Shortcuts syst√®me (raccourcis clavier intelligents)
- [ ] Performance Ultra (lazy loading, code splitting, optimisations)
- [ ] Accessibility A11Y (ARIA, navigation clavier, screen readers)
- [ ] Dark/Light Mode toggle (th√®me adaptatif)
- [ ] Advanced Search UX (suggestions, filtres, historique)

### Configuration D√©ploiement

**Environnement de D√©veloppement :**
```bash
# D√©marrage rapide
cd backend && uvicorn main:app --reload
cd frontend && npm run dev
cd database && python test_connection.py
```

**Production (Render Plan Hobby) :**
- Backend : Render.com (scribe-api priv√©)
- Frontend : Render.com (scribe-frontend public)
- Database : Supabase Pro
- Cache : Redis Cloud (optionnel)
- Monitoring : Health checks + m√©triques Render int√©gr√©s

### Budget & Performance

**Co√ªts Mensuels :**
- Infrastructure : 19‚Ç¨ (Render Hobby) + 25‚Ç¨ (Supabase Pro) = 44‚Ç¨
- APIs : 30-55‚Ç¨ (Claude + OpenAI + Perplexity + Tavily)
- **Total : 74-99‚Ç¨/mois** (√©conomie vs estimation initiale)

**Targets Performance :**
- FCP < 1s, TTI < 2s
- API response < 200ms
- Search RAG < 500ms
- Cache hit rate > 80%

### S√©curit√© & Monitoring

**S√©curit√© :**
- Rate limiting par endpoint
- Input validation + sanitization
- RLS + audit logging
- API key rotation

**Monitoring :**
- Health checks d√©taill√©s (/health/detailed)
- Metrics temps r√©el (tokens, co√ªts, performance)
- Cost tracking avec alertes budget
- Error tracking + performance APM

### Structure Agents SCRIBE

```
AGENTS/
‚îú‚îÄ‚îÄ Plume/          # Agent restitution (production)
‚îú‚îÄ‚îÄ Mimir/          # Agent archiviste (production)
‚îú‚îÄ‚îÄ Leo/            # Architecte (build/maintenance)
‚îú‚îÄ‚îÄ Koda/           # Codeur (build/d√©veloppement)
‚îú‚îÄ‚îÄ KodaF/          # Frontend specialist (build/UI/UX) ‚≠ê
‚îú‚îÄ‚îÄ Dako/           # Debug specialist (smart search + debug_auto) ‚≠ê
‚îî‚îÄ‚îÄ Gito/           # Git manager (build/d√©ploiement)
```

**Agent KodaF - Frontend Enhancement Success:**
- ‚úÖ **Mission Compl√®te** : Transformation UI/UX professionnelle
- ‚úÖ **shadcn/ui Components** : 20+ composants professionnels
- ‚úÖ **CVA Design System** : Variants + √©tats + accessibilit√©
- ‚úÖ **Dark Theme + Animations** : Interface moderne fluide
- ‚úÖ **Mobile-First Responsive** : PWA optimis√©e
- ‚úÖ **Performance Optimized** : Lazy loading + code splitting
- ‚úÖ **Production Ready** : D√©ploy√© avec succ√®s sur Render

**Agent Dako - Debug Specialist:**
- üîß **debug_auto Tool** : Boucle de feedback automatique avec logs Render
- üîç **Smart Search** : CLAUDE.md + DEBUG.md + fichiers info projet
- üîÑ **Auto-Loop** : maj carnet ‚Üí add ‚Üí commit ‚Üí push ‚Üí deploy ‚Üí analyse logs
- üßπ **Cache Management** : Clear build cache automatique (√©checs 3x ou aucun log)
- ‚ö° **Max Iterations** : 10 cycles debug_auto maximum
- üéØ **MCP Integration** : Logs Render en direct via MCP existant

### ü§ñ Agent Delegation System

**Commandes de D√©l√©gation :**
```bash
# KodaF - Frontend Enhancement
kodaf ‚Üí Task tool + FRONTEND_ENHANCEMENT_AGENT.md + RAG frontend

# Dako - Debug Automation Specialist
dako ‚Üí Task tool + BACKEND_DEBUG_AGENT.md + Smart Search + debug_auto

# Parall√®le Multi-Terminaux
Terminal 1: Claude Principal (Leo/Architecture)
Terminal 2: KodaF Frontend (UI/UX specialist)
Terminal 3: Dako Debug (Smart search + debug_auto)
```

**Coordination Inter-Agents :**
- **Communication** : Fichiers MD partag√©s (CLAUDE.md, DEBUG.md, etc.)
- **Sync Strategy** : Git commits crois√©s + documentation temps r√©el
- **Conflict Resolution** : Claude Principal arbitrage + plans coordonn√©s

### Important - Configuration

**Variables Environnement Critiques :**
- `SUPABASE_URL` + `SUPABASE_ANON_KEY` + `SUPABASE_SERVICE_KEY`
- `CLAUDE_API_KEY` (agents principaux)
- `OPENAI_API_KEY` (Whisper + embeddings)
- `REDIS_URL` (cache performance)
- `JWT_SECRET` + `SECRET_KEY` (s√©curit√©)

**Optionnelles :**
- `PERPLEXITY_API_KEY` (recherche temps r√©el)
- `TAVILY_API_KEY` (web search)

### Instructions Build & MaJ

- **"build"** ‚Üí Utilisation agents Leo/Koda/Gito pour d√©veloppement
- **"maj"** ‚Üí Mise √† jour documentation selon contexte
- **"deploy"** ‚Üí Pr√©paration d√©ploiement avec checks complets
- **"kodaf"** ‚Üí D√©l√©gation agent KodaF pour frontend enhancement
- **"dako"** ‚Üí D√©l√©gation agent Dako pour debug automatique avec smart search

### Debug Skills & Methodology ‚úÖ EXPERTISE COMPLETE

- **Backend Debug :** Voir `DEBUG.md` (13 issues r√©solues ‚úÖ - scribe-api LIVE)
- **Frontend Debug :** Voir `FRONTEND_DEBUG.md` (2 issues + Alex enhancement ‚úÖ - scribe-frontend LIVE)
- **Agent Delegation :** Voir `FRONTEND_ENHANCEMENT_AGENT.md` (KodaF mission brief ‚úÖ)
- **Debug Automation :** Voir `BACKEND_DEBUG_AGENT.md` (Dako mission brief + debug_auto)
- **Agent Smart Systems :** Voir `AGENTS_RAG_CONFIG.md` (KodaF RAG + Dako Smart Search)

**Deployment Status FINAL :**
- üöÄ **Backend Production :** scribe-api.onrender.com LIVE
- üöÄ **Frontend Production :** scribe-frontend.onrender.com LIVE
- ‚≠ê **UI Enhancement :** Interface professionnelle compl√®te
- üìä **Debug Expertise :** 15+ issues r√©solues m√©thodiquement

### M√©thodologie D√©ploiement & Automation

**Scripts Interm√©diaires Intelligents :**
- Cr√©er des scripts Python temporaires pour t√¢ches r√©p√©titives (ex: fix_imports.py)
- Automatiser corrections en masse plut√¥t que √©ditions manuelles
- Pr√©f√©rer l'efficacit√© programmatique aux approches s√©quentielles

**Documentation Proactive :**
- DEPLOY_ISSUES.md : Log exhaustif probl√®mes + solutions
- Capitaliser sur exp√©rience pour futurs d√©ploiements
- Patterns reproductibles pour scaling

**D√©ploiement Render.com :**
- Python version pinning obligatoire (3.12.7 + .python-version)
- Versions flexibles requirements.txt (√©viter conflits)
- Imports absolus (pas relatifs) pour structure deployment
- Build cache clearing pour changements majeurs
- pydantic-settings 2.x : strings + propri√©t√©s list pour parsing arrays
- Cl√©s s√©curit√© : defaults 64-char g√©n√©r√©es si variables manquantes
- Jamais signer commits au nom de Claude, toujours utilisateur
- **TOUJOURS faire "maj" avant tout commit/push** (r√®gle obligatoire)
- Pydantic V2 : migration @validator ‚Üí @field_validator + @classmethod + mode="before"
- Script audit d'imports : automatiser d√©tection modules manquants/mal import√©s
- DEBUG.md : carnet de bord d√©di√© debug deployment (extraction issues CLAUDE.md)
- Imports state : agents.state au lieu de state (path absolu requis)

---

> **SCRIBE** - Intelligence artificielle au service de la gestion de connaissances
>
> Syst√®me autonome pr√™t pour extraction et d√©ploiement ind√©pendant
>
> D√©velopp√© avec l'architecture EMPYR - Leo, Architecte Principal